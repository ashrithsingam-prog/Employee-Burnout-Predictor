<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Wellbeing Support</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=Outfit:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    <style>
        :root {
            --white: #fff;
            --off: #f8f7f4;
            --off2: #f0ede8;
            --border: #e5e0d8;
            --border2: #d4cfc6;
            --ink: #1a1814;
            --ink2: #3a3630;
            --muted: #8a8078;
            --muted2: #b8b0a6;
            --green: #1a7a4a;
            --green-bg: #edf7f2;
            --green-mid: #2da863;
            --amber: #b85c00;
            --amber-bg: #fff4e8;
            --red: #c0302a;
            --red-bg: #fff0ef;
            --blue: #1d5fa8;
            --blue-bg: #eef4fd;
            --purple: #6b3fa0;
            --purple-bg: #f4eeff;
            --radius: 10px;
            --shadow-sm: 0 1px 4px rgba(26, 24, 20, .06);
            --shadow: 0 4px 20px rgba(26, 24, 20, .08)
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0
        }

        html {
            scroll-behavior: smooth
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--white);
            color: var(--ink);
            min-height: 100vh
        }

        header {
            background: var(--white);
            border-bottom: 1px solid var(--border);
            padding: 5rem 2rem 4rem;
            text-align: center;
            position: relative;
            overflow: hidden
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 900px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--green-mid), var(--blue), transparent)
        }

        .header-eyebrow {
            display: inline-flex;
            align-items: center;
            gap: .5rem;
            font-size: .72rem;
            font-weight: 700;
            letter-spacing: .18em;
            text-transform: uppercase;
            color: var(--green);
            margin-bottom: 1.4rem
        }

        .eyebrow-line {
            width: 28px;
            height: 1.5px;
            background: var(--green)
        }

        header h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2.4rem, 5.5vw, 4rem);
            font-weight: 900;
            color: var(--ink);
            line-height: 1.08;
            max-width: 760px;
            margin: 0 auto 1.2rem;
            letter-spacing: -.02em
        }

        header h1 em {
            font-style: italic;
            color: var(--green)
        }

        header p {
            font-size: 1.05rem;
            color: var(--muted);
            max-width: 480px;
            margin: 0 auto 2.5rem;
            line-height: 1.75;
            font-weight: 300
        }

        .header-pills {
            display: inline-flex;
            gap: .5rem;
            flex-wrap: wrap;
            justify-content: center
        }

        .pill {
            padding: .4rem 1rem;
            border: 1px solid var(--border2);
            border-radius: 2rem;
            font-size: .78rem;
            font-weight: 600;
            color: var(--muted);
            background: var(--off)
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 0;
            background: var(--white);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            flex-wrap: wrap;
            padding: 0 1rem
        }

        .tab-btn {
            padding: 1rem 1.3rem;
            border: none;
            border-bottom: 2.5px solid transparent;
            background: transparent;
            cursor: pointer;
            font-family: 'Outfit', sans-serif;
            font-size: .82rem;
            font-weight: 600;
            color: var(--muted);
            letter-spacing: .02em;
            transition: all .2s;
            white-space: nowrap;
            margin-bottom: -1px
        }

        .tab-btn:hover {
            color: var(--ink);
            border-bottom-color: var(--border2)
        }

        .tab-btn.active {
            color: var(--green);
            border-bottom-color: var(--green)
        }

        .section {
            display: none;
            padding: 3rem 1rem 5rem;
            max-width: 900px;
            margin: 0 auto
        }

        .section.active {
            display: block;
            animation: fadeUp .35s ease
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(14px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        .section-label {
            font-size: .7rem;
            font-weight: 700;
            letter-spacing: .2em;
            text-transform: uppercase;
            color: var(--green);
            margin-bottom: .6rem
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--ink);
            line-height: 1.15;
            margin-bottom: .6rem;
            letter-spacing: -.02em
        }

        .section-sub {
            color: var(--muted);
            font-size: .95rem;
            margin-bottom: 2.5rem;
            line-height: 1.7;
            max-width: 600px;
            font-weight: 300
        }

        /* STEPS */
        .steps {
            display: flex;
            flex-direction: column;
            gap: 0
        }

        .step {
            display: grid;
            grid-template-columns: 56px 1fr;
            gap: 0;
            position: relative;
            opacity: 0;
            transform: translateY(16px);
            transition: all .5s ease
        }

        .step.visible {
            opacity: 1;
            transform: translateY(0)
        }

        .step-left {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 4px
        }

        .step-num {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: .85rem;
            flex-shrink: 0;
            border: 1.5px solid;
            position: relative;
            z-index: 1
        }

        .step-connector {
            width: 1px;
            flex: 1;
            margin: 6px 0 0;
            min-height: 24px;
            border-left: 1.5px dashed var(--border2)
        }

        .step:last-child .step-connector {
            display: none
        }

        .step-body {
            padding: 0 0 2.5rem 1.4rem
        }

        .step-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.4rem 1.6rem;
            box-shadow: var(--shadow-sm);
            transition: box-shadow .2s;
            cursor: pointer
        }

        .step-card:hover {
            box-shadow: var(--shadow)
        }

        .step-card h3 {
            font-size: .97rem;
            font-weight: 700;
            margin-bottom: .5rem
        }

        .step-card p {
            font-size: .86rem;
            color: var(--muted);
            line-height: 1.7;
            font-weight: 300
        }

        .step-tags {
            display: flex;
            flex-wrap: wrap;
            gap: .35rem;
            margin-top: 1rem
        }

        .tag {
            font-size: .7rem;
            font-weight: 600;
            padding: .2rem .65rem;
            border-radius: 2rem;
            letter-spacing: .03em;
            border: 1px solid
        }

        .v-green .step-num {
            background: var(--green-bg);
            color: var(--green);
            border-color: var(--green)
        }

        .v-green .step-card {
            border-left: 3px solid var(--green)
        }

        .v-green .step-card h3 {
            color: var(--green)
        }

        .tag-green {
            background: var(--green-bg);
            color: var(--green);
            border-color: rgba(26, 122, 74, .25)
        }

        .v-blue .step-num {
            background: var(--blue-bg);
            color: var(--blue);
            border-color: var(--blue)
        }

        .v-blue .step-card {
            border-left: 3px solid var(--blue)
        }

        .v-blue .step-card h3 {
            color: var(--blue)
        }

        .tag-blue {
            background: var(--blue-bg);
            color: var(--blue);
            border-color: rgba(29, 95, 168, .25)
        }

        .v-amber .step-num {
            background: var(--amber-bg);
            color: var(--amber);
            border-color: var(--amber)
        }

        .v-amber .step-card {
            border-left: 3px solid var(--amber)
        }

        .v-amber .step-card h3 {
            color: var(--amber)
        }

        .tag-amber {
            background: var(--amber-bg);
            color: var(--amber);
            border-color: rgba(184, 92, 0, .25)
        }

        .v-red .step-num {
            background: var(--red-bg);
            color: var(--red);
            border-color: var(--red)
        }

        .v-red .step-card {
            border-left: 3px solid var(--red)
        }

        .v-red .step-card h3 {
            color: var(--red)
        }

        .tag-red {
            background: var(--red-bg);
            color: var(--red);
            border-color: rgba(192, 48, 42, .25)
        }

        /* ETHICS */
        .ethics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
            gap: 1px;
            background: var(--border);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden
        }

        .ethics-card {
            background: var(--white);
            padding: 1.6rem;
            opacity: 0;
            transform: scale(.97);
            transition: all .35s ease;
            cursor: default;
            position: relative
        }

        .ethics-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: transparent;
            transition: background .2s
        }

        .ethics-card:hover::before {
            background: var(--green)
        }

        .ethics-card.visible {
            opacity: 1;
            transform: scale(1)
        }

        .ethics-card:hover {
            background: var(--off)
        }

        .ethics-icon {
            font-size: 1.6rem;
            margin-bottom: .8rem;
            display: block
        }

        .ethics-card h4 {
            font-size: .9rem;
            font-weight: 700;
            margin-bottom: .4rem;
            color: var(--ink)
        }

        .ethics-card p {
            font-size: .8rem;
            color: var(--muted);
            line-height: 1.65;
            font-weight: 300
        }

        /* OUTCOMES */
        .outcomes-table {
            width: 100%;
            border-collapse: collapse;
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-sm)
        }

        .outcomes-table th {
            background: var(--off);
            color: var(--muted);
            padding: .85rem 1.2rem;
            text-align: left;
            font-size: .72rem;
            font-weight: 700;
            letter-spacing: .1em;
            text-transform: uppercase;
            border-bottom: 1px solid var(--border)
        }

        .outcomes-table td {
            padding: 1rem 1.2rem;
            font-size: .86rem;
            border-bottom: 1px solid var(--border);
            color: var(--ink2);
            vertical-align: middle;
            font-weight: 300
        }

        .outcomes-table tr:last-child td {
            border-bottom: none
        }

        .outcomes-table tr:hover td {
            background: var(--off)
        }

        .badge {
            display: inline-block;
            padding: .25rem .75rem;
            border-radius: 2rem;
            font-size: .72rem;
            font-weight: 700;
            letter-spacing: .04em;
            border: 1px solid
        }

        .badge-green {
            background: var(--green-bg);
            color: var(--green);
            border-color: rgba(26, 122, 74, .3)
        }

        .badge-amber {
            background: var(--amber-bg);
            color: var(--amber);
            border-color: rgba(184, 92, 0, .3)
        }

        .badge-red {
            background: var(--red-bg);
            color: var(--red);
            border-color: rgba(192, 48, 42, .3)
        }

        .badge-purple {
            background: var(--purple-bg);
            color: var(--purple);
            border-color: rgba(107, 63, 160, .3)
        }

        .info-strip {
            margin-top: 1.5rem;
            padding: 1.2rem 1.5rem;
            background: var(--green-bg);
            border-radius: var(--radius);
            border-left: 3px solid var(--green);
            font-size: .86rem;
            color: var(--ink2);
            line-height: 1.7;
            font-weight: 300
        }

        .info-strip strong {
            color: var(--green);
            font-weight: 700
        }

        /* DASHBOARD */
        .dash-grid {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem
        }

        @media(max-width:700px) {
            .dash-grid {
                grid-template-columns: 1fr
            }
        }

        .profile-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.8rem;
            box-shadow: var(--shadow-sm);
            text-align: center
        }

        .profile-avatar {
            width: 72px;
            height: 72px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--green-bg), var(--blue-bg));
            border: 2px solid var(--green);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 1rem
        }

        .profile-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--ink);
            margin-bottom: .2rem
        }

        .profile-role {
            font-size: .78rem;
            color: var(--muted);
            text-transform: capitalize;
            margin-bottom: 1.2rem
        }

        .profile-stat {
            display: flex;
            justify-content: space-between;
            padding: .55rem 0;
            border-top: 1px solid var(--border);
            font-size: .82rem
        }

        .profile-stat span:first-child {
            color: var(--muted);
            font-weight: 400
        }

        .profile-stat span:last-child {
            font-weight: 700
        }

        .wellness-ring {
            position: relative;
            width: 140px;
            height: 140px;
            margin: 0 auto 1rem
        }

        .wellness-ring svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg)
        }

        .wellness-ring .bg {
            fill: none;
            stroke: var(--off2);
            stroke-width: 10
        }

        .wellness-ring .fill {
            fill: none;
            stroke-width: 10;
            stroke-linecap: round;
            transition: stroke-dashoffset .8s ease, stroke .4s
        }

        .wellness-ring .label {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center
        }

        .wellness-ring .label .val {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 900;
            line-height: 1
        }

        .wellness-ring .label .sub {
            font-size: .72rem;
            color: var(--muted);
            margin-top: .2rem
        }

        .dash-right {
            display: flex;
            flex-direction: column;
            gap: 1rem
        }

        .dash-top {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1px;
            background: var(--border);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden
        }

        .kpi {
            background: var(--white);
            padding: 1.3rem 1.2rem;
            position: relative
        }

        .kpi::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 1.2rem;
            right: 1.2rem;
            height: 2px;
            border-radius: 2px
        }

        .kpi.green::after {
            background: var(--green)
        }

        .kpi.amber::after {
            background: var(--amber)
        }

        .kpi.red::after {
            background: var(--red)
        }

        .kpi.blue::after {
            background: var(--blue)
        }

        .kpi-label {
            font-size: .7rem;
            font-weight: 700;
            letter-spacing: .1em;
            text-transform: uppercase;
            color: var(--muted2);
            margin-bottom: .5rem
        }

        .kpi-val {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            font-weight: 700;
            line-height: 1
        }

        .kpi.green .kpi-val {
            color: var(--green)
        }

        .kpi.amber .kpi-val {
            color: var(--amber)
        }

        .kpi.red .kpi-val {
            color: var(--red)
        }

        .kpi.blue .kpi-val {
            color: var(--blue)
        }

        .kpi-sub {
            font-size: .72rem;
            color: var(--muted2);
            margin-top: .3rem
        }

        .charts-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem
        }

        .chart-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.4rem;
            box-shadow: var(--shadow-sm)
        }

        .chart-label {
            font-size: .7rem;
            font-weight: 700;
            letter-spacing: .12em;
            text-transform: uppercase;
            color: var(--muted);
            margin-bottom: 1rem
        }

        .chart-wrap {
            position: relative;
            height: 190px
        }

        .history-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.4rem 1.6rem;
            box-shadow: var(--shadow-sm);
            margin-top: 1rem
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: .7rem 0;
            border-bottom: 1px solid var(--border);
            font-size: .84rem
        }

        .history-item:last-child {
            border-bottom: none
        }

        .history-date {
            color: var(--muted);
            font-weight: 300
        }

        .book-card {
            background: linear-gradient(135deg, var(--green-bg), var(--blue-bg));
            border: 1px solid rgba(26, 122, 74, .2);
            border-radius: var(--radius);
            padding: 1.8rem;
            margin-top: 1rem;
            text-align: center
        }

        .book-card h4 {
            font-size: 1rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: .4rem
        }

        .book-card p {
            font-size: .84rem;
            color: var(--muted);
            margin-bottom: 1.2rem;
            font-weight: 300
        }

        /* CHATBOT */
        .chat-layout {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 1.5rem;
            align-items: start
        }

        @media(max-width:700px) {
            .chat-layout {
                grid-template-columns: 1fr
            }
        }

        .chat-window {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 560px;
            box-shadow: var(--shadow)
        }

        .chat-head {
            background: var(--off);
            padding: 1rem 1.4rem;
            display: flex;
            align-items: center;
            gap: .9rem;
            border-bottom: 1px solid var(--border)
        }

        .chat-av {
            width: 38px;
            height: 38px;
            background: var(--green-bg);
            border: 1.5px solid rgba(26, 122, 74, .3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem
        }

        .chat-head-name {
            font-weight: 700;
            font-size: .9rem;
            color: var(--ink)
        }

        .chat-head-status {
            font-size: .72rem;
            color: var(--muted);
            display: flex;
            align-items: center;
            gap: .35rem;
            margin-top: 1px
        }

        .online-dot {
            width: 6px;
            height: 6px;
            background: #4eca7a;
            border-radius: 50%;
            animation: blink 2s infinite
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1
            }

            50% {
                opacity: .3
            }
        }

        .chat-msgs {
            flex: 1;
            overflow-y: auto;
            padding: 1.4rem 1.2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            scroll-behavior: smooth;
            background: var(--off)
        }

        .chat-msgs::-webkit-scrollbar {
            width: 3px
        }

        .chat-msgs::-webkit-scrollbar-thumb {
            background: var(--border2);
            border-radius: 2px
        }

        .msg {
            display: flex;
            gap: .6rem;
            animation: msgIn .3s ease
        }

        @keyframes msgIn {
            from {
                opacity: 0;
                transform: translateY(6px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        .msg.bot {
            align-items: flex-start
        }

        .msg.user {
            flex-direction: row-reverse
        }

        .msg-av {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: .75rem;
            flex-shrink: 0;
            margin-top: 2px
        }

        .msg.bot .msg-av {
            background: var(--green-bg);
            color: var(--green);
            border: 1px solid rgba(26, 122, 74, .2)
        }

        .msg.user .msg-av {
            background: var(--border2);
            color: var(--muted)
        }

        .msg-bub {
            max-width: 80%;
            padding: .75rem 1rem;
            border-radius: 12px;
            font-size: .86rem;
            line-height: 1.6
        }

        .msg.bot .msg-bub {
            background: var(--white);
            color: var(--ink2);
            border-bottom-left-radius: 3px;
            border: 1px solid var(--border);
            font-weight: 300;
            box-shadow: var(--shadow-sm)
        }

        .msg.user .msg-bub {
            background: var(--green);
            color: #fff;
            border-bottom-right-radius: 3px;
            font-weight: 400
        }

        .chat-foot {
            padding: .9rem 1.2rem;
            border-top: 1px solid var(--border);
            background: var(--white)
        }

        .chat-foot-label {
            font-size: .68rem;
            font-weight: 700;
            letter-spacing: .1em;
            text-transform: uppercase;
            color: var(--muted2);
            margin-bottom: .5rem
        }

        .chat-opts {
            display: flex;
            flex-wrap: wrap;
            gap: .4rem
        }

        .copt {
            padding: .45rem .9rem;
            background: var(--off);
            border: 1px solid var(--border2);
            border-radius: 2rem;
            font-size: .8rem;
            font-weight: 500;
            color: var(--ink2);
            cursor: pointer;
            font-family: 'Outfit', sans-serif;
            transition: all .15s
        }

        .copt:hover {
            background: var(--ink);
            color: #fff;
            border-color: var(--ink)
        }

        .copt.used {
            opacity: .35;
            pointer-events: none
        }

        .typing-bub {
            display: flex;
            gap: 4px;
            padding: .6rem .9rem;
            align-items: center
        }

        .typing-bub span {
            width: 7px;
            height: 7px;
            background: var(--muted2);
            border-radius: 50%;
            animation: bounce 1.2s infinite
        }

        .typing-bub span:nth-child(2) {
            animation-delay: .18s
        }

        .typing-bub span:nth-child(3) {
            animation-delay: .36s
        }

        @keyframes bounce {

            0%,
            60%,
            100% {
                transform: translateY(0)
            }

            30% {
                transform: translateY(-5px)
            }
        }

        .chat-sidebar {
            display: flex;
            flex-direction: column;
            gap: 1rem
        }

        .side-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.2rem 1.3rem;
            box-shadow: var(--shadow-sm)
        }

        .side-label {
            font-size: .68rem;
            font-weight: 700;
            letter-spacing: .12em;
            text-transform: uppercase;
            color: var(--muted2);
            margin-bottom: .8rem
        }

        .prog-track {
            background: var(--off2);
            border-radius: 4px;
            height: 7px;
            overflow: hidden
        }

        .prog-fill {
            height: 100%;
            background: var(--green);
            border-radius: 4px;
            width: 0%;
            transition: width .5s ease
        }

        .prog-text {
            font-size: .76rem;
            color: var(--muted);
            margin-top: .5rem;
            font-weight: 300
        }

        .score-badge {
            display: none;
            padding: .7rem 1rem;
            border-radius: 8px;
            margin-top: .5rem;
            font-weight: 600;
            font-size: .86rem;
            border: 1px solid
        }

        .score-badge.show {
            display: block
        }

        .privacy-note {
            font-size: .78rem;
            color: var(--muted);
            line-height: 1.65;
            font-weight: 300
        }

        .privacy-note strong {
            color: var(--ink2);
            font-weight: 600
        }

        /* EMPLOYEE TEST */
        .test-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 2rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-sm);
            transition: all .3s
        }

        .test-card.answered {
            opacity: .7
        }

        .test-card.answered.active-card {
            opacity: 1
        }

        .test-q {
            font-weight: 700;
            font-size: .97rem;
            margin-bottom: .4rem;
            line-height: 1.5;
            color: var(--ink)
        }

        .test-context {
            font-size: .82rem;
            color: var(--muted);
            margin-bottom: 1.2rem;
            line-height: 1.6;
            font-weight: 300;
            font-style: italic
        }

        .test-opts {
            display: flex;
            flex-direction: column;
            gap: .55rem
        }

        .topt {
            padding: .85rem 1.2rem;
            border: 1.5px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            font-size: .86rem;
            transition: all .18s;
            background: var(--off);
            color: var(--ink2);
            text-align: left;
            font-family: 'Outfit', sans-serif;
            font-weight: 400;
            position: relative;
            line-height: 1.5
        }

        .topt:hover:not(.picked) {
            border-color: var(--green);
            background: var(--green-bg);
            color: var(--green)
        }

        .topt.picked {
            border-color: var(--green);
            background: var(--green-bg);
            color: var(--green);
            font-weight: 600
        }

        .topt.picked::before {
            content: "\2713 ";
            font-weight: 700
        }

        .topt.locked {
            pointer-events: none;
            opacity: .4
        }

        .topt.picked.locked {
            opacity: 1
        }

        .test-explain {
            margin-top: 1rem;
            padding: 1rem 1.2rem;
            border-radius: 8px;
            font-size: .84rem;
            line-height: 1.65;
            display: none;
            font-weight: 300;
            background: var(--green-bg);
            color: var(--green);
            border-left: 3px solid var(--green)
        }

        .test-explain.show {
            display: block;
            animation: fadeUp .3s ease
        }

        .test-result {
            text-align: center;
            padding: 3rem 2rem;
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            display: none;
            box-shadow: var(--shadow)
        }

        .test-result h3 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 900;
            color: var(--green);
            margin-bottom: .5rem
        }

        .test-result p {
            color: var(--muted);
            font-weight: 300;
            line-height: 1.7;
            max-width: 500px;
            margin: 0 auto
        }

        /* BTN */
        .btn {
            display: inline-block;
            margin-top: 1.5rem;
            padding: .8rem 2rem;
            background: var(--green);
            color: #fff;
            border: none;
            border-radius: 2rem;
            font-family: 'Outfit', sans-serif;
            font-size: .88rem;
            font-weight: 700;
            cursor: pointer;
            transition: all .2s;
            letter-spacing: .03em
        }

        .btn:hover {
            background: var(--ink);
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(26, 24, 20, .15)
        }

        .btn-outline {
            background: transparent;
            border: 1.5px solid var(--green);
            color: var(--green)
        }

        .btn-outline:hover {
            background: var(--green);
            color: #fff
        }

        /* MODAL */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, .5);
            z-index: 600;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
            animation: fadeIn .2s
        }

        .modal-overlay.show {
            display: flex
        }

        @keyframes fadeIn {
            from {
                opacity: 0
            }

            to {
                opacity: 1
            }
        }

        .modal {
            background: var(--white);
            border-radius: 16px;
            padding: 2.5rem 2rem;
            max-width: 480px;
            width: 90%;
            box-shadow: 0 24px 64px rgba(0, 0, 0, .2);
            animation: scaleIn .25s ease
        }

        @keyframes scaleIn {
            from {
                transform: scale(.95);
                opacity: 0
            }

            to {
                transform: scale(1);
                opacity: 1
            }
        }

        .modal h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: .6rem;
            color: var(--ink)
        }

        .modal p {
            font-size: .88rem;
            color: var(--muted);
            line-height: 1.65;
            margin-bottom: 1.5rem;
            font-weight: 300
        }

        .modal label {
            display: block;
            font-size: .78rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: .4rem
        }

        .modal select,
        .modal input[type="date"] {
            width: 100%;
            padding: .7rem 1rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: 'Outfit', sans-serif;
            font-size: .86rem;
            background: var(--off);
            color: var(--ink);
            margin-bottom: 1rem;
            outline: none
        }

        .modal select:focus,
        .modal input:focus {
            border-color: var(--green)
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1.2rem;
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--muted);
            line-height: 1
        }

        .modal-close:hover {
            color: var(--red)
        }

        .modal-success {
            text-align: center;
            padding: 2rem
        }

        .modal-success .check {
            font-size: 3rem;
            margin-bottom: 1rem
        }

        /* TOOLBAR */
        .toolbar {
            display: none;
            align-items: center;
            justify-content: flex-end;
            gap: .6rem;
            padding: .5rem 1.2rem;
            background: var(--white);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 49px;
            z-index: 90
        }

        .toolbar.show {
            display: flex
        }

        .tb-label {
            font-size: .76rem;
            font-weight: 600;
            color: var(--muted);
            margin-right: auto
        }

        .tb-label span {
            color: var(--green);
            font-weight: 700
        }

        .tb-btn {
            width: 36px;
            height: 36px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--off);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: all .18s;
            position: relative;
            color: var(--ink)
        }

        .tb-btn:hover {
            border-color: var(--green);
            background: var(--green-bg)
        }

        .notif-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 17px;
            height: 17px;
            background: var(--red);
            color: #fff;
            border-radius: 50%;
            font-size: .58rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--white);
            pointer-events: none
        }

        .notif-panel {
            position: fixed;
            top: 94px;
            right: 1rem;
            width: 340px;
            max-height: 460px;
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 14px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, .12);
            z-index: 500;
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: slideDown .22s ease
        }

        .notif-panel.show {
            display: flex
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-8px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        .notif-head {
            padding: 1rem 1.2rem .8rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between
        }

        .notif-head h4 {
            font-size: .9rem;
            font-weight: 700;
            color: var(--ink)
        }

        .notif-close {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--muted);
            font-size: 1.1rem;
            padding: .2rem
        }

        .notif-close:hover {
            color: var(--red)
        }

        .notif-list {
            overflow-y: auto;
            flex: 1;
            padding: .4rem 0
        }

        .notif-item {
            padding: .85rem 1.2rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: .8rem;
            align-items: flex-start;
            transition: background .15s;
            cursor: default
        }

        .notif-item:last-child {
            border-bottom: none
        }

        .notif-item:hover {
            background: var(--off)
        }

        .notif-item.unread {
            background: var(--green-bg)
        }

        .notif-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
            margin-top: 1px
        }

        .notif-body .n-title {
            font-size: .84rem;
            font-weight: 600;
            color: var(--ink);
            margin-bottom: .15rem
        }

        .notif-body .n-msg {
            font-size: .79rem;
            color: var(--muted);
            line-height: 1.5
        }

        .notif-body .n-time {
            font-size: .7rem;
            color: var(--muted2);
            margin-top: .25rem
        }

        .notif-footer {
            padding: .6rem 1.2rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center
        }

        .notif-count {
            font-size: .72rem;
            color: var(--muted2)
        }

        .notif-clear {
            background: none;
            border: none;
            cursor: pointer;
            font-size: .75rem;
            color: var(--muted);
            font-family: 'Outfit', sans-serif
        }

        .notif-clear:hover {
            color: var(--red)
        }

        /* DARK MODE */
        body.dark {
            --white: #111318;
            --off: #181c24;
            --off2: #1f2330;
            --border: #2a2f3e;
            --border2: #353b4f;
            --ink: #e8ecf4;
            --ink2: #c4cad8;
            --muted: #7a849e;
            --muted2: #4a526a;
            --green-bg: rgba(26, 122, 74, .15);
            --amber-bg: rgba(184, 92, 0, .15);
            --red-bg: rgba(192, 48, 42, .15);
            --blue-bg: rgba(29, 95, 168, .15);
            --purple-bg: rgba(107, 63, 160, .15);
            --shadow-sm: 0 1px 4px rgba(0, 0, 0, .3);
            --shadow: 0 4px 20px rgba(0, 0, 0, .4)
        }

        body.dark .outcomes-table td {
            background: var(--white)
        }

        body.dark .outcomes-table th {
            background: var(--off2)
        }

        body.dark .outcomes-table tr:hover td {
            background: var(--off)
        }

        body.dark .chat-msgs {
            background: var(--off2)
        }

        body.dark .msg.bot .msg-bub {
            background: var(--off);
            border-color: var(--border)
        }

        body.dark .topt,
        body.dark .copt {
            background: var(--off);
            border-color: var(--border);
            color: var(--ink2)
        }

        body.dark header,
        .dark .nav-tabs {
            background: var(--white)
        }

        body.dark .step-card,
        body.dark .test-card,
        body.dark .ethics-card,
        body.dark .kpi,
        body.dark .chart-card,
        body.dark .side-card,
        body.dark .chat-window,
        body.dark .chat-foot,
        body.dark .profile-card,
        body.dark .history-card,
        body.dark .modal {
            background: var(--off);
            border-color: var(--border)
        }

        body.dark .pill {
            background: var(--off2);
            border-color: var(--border)
        }

        body.dark .notif-panel {
            background: var(--off);
            border-color: var(--border)
        }

        body.dark .notif-item.unread {
            background: rgba(26, 122, 74, .12)
        }

        body.dark .book-card {
            background: linear-gradient(135deg, rgba(26, 122, 74, .12), rgba(29, 95, 168, .12));
            border-color: var(--border)
        }

        @media(max-width:600px) {
            .dash-top {
                grid-template-columns: 1fr
            }

            .charts-row {
                grid-template-columns: 1fr
            }

            .ethics-grid {
                grid-template-columns: 1fr 1fr
            }
        }

        @media(max-width:420px) {
            .ethics-grid {
                grid-template-columns: 1fr
            }
        }

        /* STRESS METERS (Test Results) */
        .stress-meter {
            margin-bottom: 1.2rem;
            opacity: 0;
            transform: translateY(10px);
            animation: fadeUp .4s forwards;
        }

        .sm-head {
            display: flex;
            align-items: center;
            gap: .6rem;
            margin-bottom: .45rem;
            font-size: .84rem;
        }

        .sm-icon {
            font-size: 1.1rem;
        }

        .sm-label {
            font-weight: 600;
            color: var(--ink2);
            flex: 1;
        }

        .sm-pct {
            font-weight: 700;
            font-family: 'Playfair Display', serif;
        }

        .sm-tag {
            font-size: .65rem;
            font-weight: 700;
            padding: .15rem .5rem;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: .05em;
        }

        .sm-track {
            height: 6px;
            background: var(--off2);
            border-radius: 3px;
            overflow: hidden;
        }

        .sm-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 1.2s cubic-bezier(.4, 0, .2, 1);
        }

        /* TEAM DATABASE ADDITIONAL STYLES */
        #dbSearch:focus {
            border-color: var(--green) !important;
            background: var(--white) !important;
            box-shadow: 0 0 0 3px rgba(26, 122, 74, .1);
            outline: none;
        }

        .outcomes-table td button:hover {
            background: var(--green);
            color: var(--white);
            border-color: var(--green);
        }
    </style>
</head>

<body>
<div class="toolbar" id="toolbar">
    <div class="tb-label">Logged in as <span id="tbName">Demo User</span></div>
    <button class="tb-btn" id="notifBtn" onclick="toggleNotif()">&#x1F514;<span class="notif-badge"
            id="notifBadge">3</span></button>
    <button class="tb-btn" id="darkBtn" onclick="toggleDark()">&#x1F319;</button>
    <button class="tb-btn" onclick="goToLogin()" title="Sign Out">&#x23FB;</button>
</div>
<div class="notif-panel" id="notifPanel">
    <div class="notif-head">
        <h4>Notifications</h4><button class="notif-close" onclick="toggleNotif()">&#x2715;</button>
    </div>
    <div class="notif-list" id="notifList"></div>
    <div class="notif-footer"><span class="notif-count" id="notifCount"></span><button class="notif-clear"
            onclick="clearAll()">Clear all</button></div>
</div>
<!-- COUNSELLOR BOOKING MODAL -->
<div class="modal-overlay" id="bookModal">
    <div class="modal" style="position:relative" id="bookModalInner">
        <button class="modal-close" onclick="closeBookModal()">&#x2715;</button>
        <div id="bookForm">
            <h3>&#x1F4C5; Book a Counsellor Session</h3>
            <p>All sessions are private and confidential. Your manager and HR will never know.</p>
            <label>Session Type</label>
            <select id="bookType">
                <option>Video Call</option>
                <option>Phone Call</option>
                <option>In-Person</option>
                <option>Text Chat</option>
            </select>
            <label>Preferred Date</label>
            <input type="date" id="bookDate">
            <label>Time Slot</label>
            <select id="bookTime">
                <option>Morning (9am-12pm)</option>
                <option>Afternoon (12pm-3pm)</option>
                <option>Evening (3pm-6pm)</option>
            </select>
            <label>Focus Area (Optional)</label>
            <select id="bookFocus">
                <option>General Wellbeing</option>
                <option>Work Stress</option>
                <option>Work-Life Balance</option>
                <option>Team Dynamics</option>
                <option>Career Concerns</option>
                <option>Prefer not to say</option>
            </select>
            <button class="btn" onclick="confirmBooking()" style="width:100%;margin-top:.5rem">Confirm Booking
                &#x2192;</button>
        </div>
        <div id="bookSuccess" style="display:none" class="modal-success">
            <div class="check">&#x2705;</div>
            <h3 style="color:var(--green)">Session Booked!</h3>
            <p style="margin-top:.5rem">Your confidential counsellor session has been scheduled. You will receive a
                private reminder. No one else will be notified.</p>
            <button class="btn" onclick="closeBookModal()"
                style="margin-top:1rem;background:var(--muted)">Close</button>
        </div>
    </div>
</div>
<!-- EMPLOYEE DETAILS MODAL (Manager / HR) -->
<div class="modal-overlay" id="detailsModal">
    <div class="modal" style="position:relative; max-width: 600px;" id="detailsModalInner">
        <button class="modal-close" onclick="closeDetailsModal()">&#x2715;</button>
        <div id="detailsContent">
            <div
                style="display:flex; align-items:center; gap:1.2rem; margin-bottom:1.5rem; padding-bottom:1.2rem; border-bottom:1px solid var(--border)">
                <div class="profile-avatar" id="detAvatar" style="margin:0; width:60px; height:60px; font-size:1.5rem">
                </div>
                <div>
                    <h3 id="detName" style="margin:0; font-size:1.4rem">Employee Details</h3>
                    <div id="detRole" style="font-size:.85rem; color:var(--muted)">Role: Software Engineer</div>
                </div>
            </div>
            <div id="detMeters"></div>
            <div id="detSummary"
                style="margin-top:1.5rem; padding:1.2rem; border-radius:var(--radius); background:var(--off2); font-size:.86rem; color:var(--ink2); line-height:1.6">
            </div>
        </div>
    </div>
</div>
<!-- LOGIN PAGE -->
<div id="loginPage" style="display:flex;min-height:100vh">
    <div
        style="flex:1;background:var(--off);display:flex;flex-direction:column;justify-content:center;padding:4rem 3rem;border-right:1px solid var(--border)">
        <div class="section-label">Employee Wellbeing</div>
        <h2
            style="font-family:'Playfair Display',serif;font-size:2.6rem;font-weight:900;color:var(--ink);margin-bottom:1rem;letter-spacing:-.02em">
            Support System</h2>
        <p
            style="color:var(--muted);font-size:.95rem;line-height:1.7;font-weight:300;max-width:360px;margin-bottom:2rem">
            A private, AI-assisted approach to identifying and supporting early signs of workplace stress.</p>
        <div style="display:flex;flex-direction:column;gap:.6rem;max-width:320px">
            <div style="display:flex;align-items:center;gap:.7rem;font-size:.84rem;color:var(--ink2);font-weight:300">
                <span style="font-size:1.1rem">&#x1F512;</span> End-to-end privacy by design
            </div>
            <div style="display:flex;align-items:center;gap:.7rem;font-size:.84rem;color:var(--ink2);font-weight:300">
                <span style="font-size:1.1rem">&#x1F9E0;</span> AI identifies patterns, not labels
            </div>
            <div style="display:flex;align-items:center;gap:.7rem;font-size:.84rem;color:var(--ink2);font-weight:300">
                <span style="font-size:1.1rem">&#x1F91D;</span> 100% voluntary participation
            </div>
            <div style="display:flex;align-items:center;gap:.7rem;font-size:.84rem;color:var(--ink2);font-weight:300">
                <span style="font-size:1.1rem">&#x1F4CA;</span> Never linked to performance
            </div>
        </div>
    </div>
    <div style="flex:1;display:flex;align-items:center;justify-content:center;padding:3rem">
        <div style="width:100%;max-width:360px">
            <div
                style="font-size:.72rem;font-weight:700;letter-spacing:.18em;text-transform:uppercase;color:var(--green);margin-bottom:1.4rem">
                Sign In</div>
            <div style="margin-bottom:1.5rem">
                <label style="font-size:.78rem;font-weight:700;color:var(--ink);display:block;margin-bottom:.5rem">Your
                    Role</label>
                <div id="roleSelect" style="display:flex;gap:.5rem;flex-wrap:wrap">
                    <button class="pill" onclick="pickRole(this,'employee')"
                        style="cursor:pointer;transition:all .18s;border:1.5px solid var(--border2)">Employee</button>
                    <button class="pill" onclick="pickRole(this,'manager')"
                        style="cursor:pointer;transition:all .18s;border:1.5px solid var(--border2)">Manager</button>
                    <button class="pill" onclick="pickRole(this,'hr')"
                        style="cursor:pointer;transition:all .18s;border:1.5px solid var(--border2)">HR</button>
                </div>
            </div>
            <div style="margin-bottom:1rem"><label
                    style="font-size:.78rem;font-weight:700;color:var(--ink);display:block;margin-bottom:.4rem">Email</label><input
                    id="loginEmail" type="email" placeholder="you@company.com"
                    style="width:100%;padding:.72rem 1rem;border:1px solid var(--border);border-radius:8px;font-family:'Outfit',sans-serif;font-size:.88rem;background:var(--off);color:var(--ink);outline:none;transition:border .2s"
                    onfocus="this.style.borderColor='var(--green)'" onblur="this.style.borderColor='var(--border)'">
            </div>
            <div style="margin-bottom:2rem"><label
                    style="font-size:.78rem;font-weight:700;color:var(--ink);display:block;margin-bottom:.4rem">Password</label><input
                    id="loginPass" type="password"
                    placeholder="&#x2022;&#x2022;&#x2022;&#x2022;&#x2022;&#x2022;&#x2022;&#x2022;"
                    style="width:100%;padding:.72rem 1rem;border:1px solid var(--border);border-radius:8px;font-family:'Outfit',sans-serif;font-size:.88rem;background:var(--off);color:var(--ink);outline:none;transition:border .2s"
                    onfocus="this.style.borderColor='var(--green)'" onblur="this.style.borderColor='var(--border)'"
                    onkeydown="if(event.key==='Enter')doLogin()"></div>
            <button class="btn" onclick="doLogin()" style="width:100%;margin-top:0">Sign In &#x2192;</button>
            <div id="loginError"
                style="display:none;margin-top:.8rem;padding:.7rem 1rem;background:var(--red-bg);border-radius:8px;font-size:.82rem;color:var(--red);border:1px solid rgba(192,48,42,.2)">
            </div>
            <p style="margin-top:1.5rem;font-size:.76rem;color:var(--muted2);text-align:center">Demo: any email &amp;
                password = "demo" with any role</p>
        </div>
    </div>
</div>
<!-- WELCOME SCREEN -->
<div id="welcomeScreen"
    style="display:none;min-height:100vh;flex-direction:column;align-items:center;justify-content:center;padding:3rem;text-align:center;background:var(--off)">
    <div style="max-width:500px;width:100%">
        <div style="font-size:3rem;margin-bottom:1.5rem" id="welcomeEmoji">&#x1F44B;</div>
        <div class="section-label" style="margin-bottom:.5rem" id="welcomeRole">Employee</div>
        <h2 style="font-family:'Playfair Display',serif;font-size:2.2rem;font-weight:900;color:var(--ink);margin-bottom:1rem;letter-spacing:-.02em"
            id="welcomeTitle">Welcome back</h2>
        <p style="color:var(--muted);font-size:.95rem;line-height:1.7;font-weight:300;margin-bottom:2rem"
            id="welcomeMsg">Your private wellbeing dashboard is ready.</p>
        <div id="welcomeFeats" style="display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center;margin-bottom:2rem">
        </div>
        <button class="btn" onclick="enterApp()">Enter Dashboard &#x2192;</button>
    </div>
</div>
<!-- MAIN APP -->
<div id="mainApp" style="display:none">
    <header>
        <div class="header-eyebrow"><span class="eyebrow-line"></span>AI-Powered Wellbeing<span
                class="eyebrow-line"></span></div>
        <h1>Employee <em>Wellbeing</em> Support System</h1>
        <p>A human-centered approach to identifying and supporting early signs of workplace stress.</p>
        <div class="header-pills"><span class="pill">Privacy-First</span><span class="pill">Voluntary</span><span
                class="pill">No Surveillance</span><span class="pill">Support-Only</span></div>
    </header>
    <nav class="nav-tabs" id="navTabs">
        <button class="tab-btn active" data-tab="workflow">Workflow</button>
        <button class="tab-btn" data-tab="dashboard">Dashboard</button>
        <button class="tab-btn" data-tab="checkin">Check-In Bot</button>
        <button class="tab-btn" data-tab="ethics">Ethics</button>
        <button class="tab-btn" data-tab="outcomes">Outcomes</button>
        <button class="tab-btn" data-tab="emptest">Employee Test</button>
        <button class="tab-btn" data-tab="teamview" id="teamTab" style="display:none">Team View</button>
    </nav>
    <!-- WORKFLOW -->
    <section id="workflow" class="section active">
        <div class="section-label">Process</div>
        <div class="section-title">System Workflow</div>
        <div class="section-sub">Five stages &#x2014; from voluntary check-in to optional support. Click any step for
            details.</div>
        <div class="steps">
            <div class="step v-green">
                <div class="step-left">
                    <div class="step-num">1</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-body">
                    <div class="step-card" onclick="this.classList.toggle('expanded')">
                        <h3>Routine Wellbeing Check</h3>
                        <p>Employees voluntarily take a short emotional wellbeing assessment every two weeks.</p>
                        <div class="step-tags"><span class="tag tag-green">Voluntary</span><span
                                class="tag tag-green">Fortnightly</span><span class="tag tag-green">Anonymous</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="step v-blue">
                <div class="step-left">
                    <div class="step-num">2</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-body">
                    <div class="step-card" onclick="this.classList.toggle('expanded')">
                        <h3>Multi-Signal Support Layer</h3>
                        <p>Behavioral indicators and anonymous peer concerns are supportive context &#x2014; not
                            surveillance.</p>
                        <div class="step-tags"><span class="tag tag-blue">Behavioral</span><span
                                class="tag tag-blue">Peer Signals</span><span class="tag tag-blue">Support-Only</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="step v-amber">
                <div class="step-left">
                    <div class="step-num">3</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-body">
                    <div class="step-card" onclick="this.classList.toggle('expanded')">
                        <h3>Follow-Up Reflective Test</h3>
                        <p>If Medium/High risk is detected, a second test after a gap confirms persistence.</p>
                        <div class="step-tags"><span class="tag tag-amber">Triggered</span><span
                                class="tag tag-amber">Gap Period</span><span class="tag tag-amber">Prevents
                                Overreaction</span></div>
                    </div>
                </div>
            </div>
            <div class="step v-amber">
                <div class="step-left">
                    <div class="step-num">4</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-body">
                    <div class="step-card" onclick="this.classList.toggle('expanded')">
                        <h3>Persistence Evaluation</h3>
                        <p>AI compares Test 1, Test 2, behavioral trends, peer signals &#x2014; patterns, not labels.
                        </p>
                        <div class="step-tags"><span class="tag tag-amber">Trend-Based</span><span
                                class="tag tag-amber">Multi-Source</span><span class="tag tag-amber">No Labels</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="step v-red">
                <div class="step-left">
                    <div class="step-num">5</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-body">
                    <div class="step-card" onclick="this.classList.toggle('expanded')">
                        <h3>Counsellor Support (Optional)</h3>
                        <p>If risk persists: &#x201C;Would you like to speak with a counsellor?&#x201D; &#x2014;
                            optional, private, support-focused.</p>
                        <div class="step-tags"><span class="tag tag-red">Optional</span><span
                                class="tag tag-red">Private</span><span class="tag tag-red">Counsellor Only</span></div>
                    </div>
                </div>
            </div>
        </div>
    </section>
<!-- DASHBOARD -->
<section id="dashboard" class="section">
    <div class="section-label">Analytics</div>
    <div class="section-title">Wellbeing Dashboard</div>
    <div class="section-sub">Your personal wellbeing overview. Complete an assessment to see live updates.</div>
    <div class="dash-grid">
        <!-- LEFT: Profile + Wellness Ring -->
        <div>
            <div class="profile-card">
                <div class="profile-avatar" id="dashAvatar">&#x1F464;</div>
                <div class="profile-name" id="dashName">Demo User</div>
                <div class="profile-role" id="dashRole">Employee</div>
                <div class="wellness-ring">
                    <svg viewBox="0 0 120 120">
                        <circle class="bg" cx="60" cy="60" r="52" />
                        <circle class="fill" id="wellRing" cx="60" cy="60" r="52" stroke="var(--green)"
                            stroke-dasharray="326.7" stroke-dashoffset="326.7" />
                    </svg>
                    <div class="label"><span class="val" id="wellVal">&#x2014;</span><span class="sub">Wellness</span>
                    </div>
                </div>
                <div class="profile-stat"><span>Last Check-In</span><span id="lastCheckin">Not yet</span></div>
                <div class="profile-stat"><span>Total Assessments</span><span id="totalAssess">0</span></div>
                <div class="profile-stat"><span>Current Streak</span><span id="streak">0 days</span></div>
            </div>
            <div class="book-card">
                <h4>&#x1F9D1;&#x200D;&#x2695;&#xFE0F; Speak with a Counsellor</h4>
                <p>Confidential. Private. No one else is notified.</p>
                <button class="btn" onclick="openBookModal()"
                    style="margin-top:0;padding:.6rem 1.5rem;font-size:.82rem">Book a Session &#x2192;</button>
            </div>
        </div>
        <!-- RIGHT: KPIs + Charts -->
        <div class="dash-right">
            <div class="dash-top">
                <div class="kpi green">
                    <div class="kpi-label">Risk Score</div>
                    <div class="kpi-val" id="kRisk">&#x2014;</div>
                    <div class="kpi-sub">Pending assessment</div>
                </div>
                <div class="kpi amber">
                    <div class="kpi-label">Classification</div>
                    <div class="kpi-val" id="kClass">&#x2014;</div>
                    <div class="kpi-sub">Complete assessment</div>
                </div>
                <div class="kpi blue">
                    <div class="kpi-label">Stress Load</div>
                    <div class="kpi-val" id="kStress">&#x2014;</div>
                    <div class="kpi-sub">Load indicator</div>
                </div>
            </div>
            <div class="charts-row">
                <div class="chart-card">
                    <div class="chart-label">Dimensions Radar</div>
                    <div class="chart-wrap"><canvas id="radarChart"></canvas></div>
                </div>
                <div class="chart-card">
                    <div class="chart-label">Category Split</div>
                    <div class="chart-wrap"><canvas id="donutChart"></canvas></div>
                </div>
            </div>
        </div>
    </div>
    <!-- ASSESSMENT -->
    <div
        style="background:var(--white);border:1px solid var(--border);border-radius:var(--radius);padding:1.8rem;box-shadow:var(--shadow-sm);margin-top:1rem">
        <div
            style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;margin-bottom:2rem">
            <div style="font-size:1rem;font-weight:700;color:var(--ink)">Interactive Assessment</div>
            <div style="display:flex;align-items:center;gap:.7rem">
                <div style="width:120px;height:6px;background:var(--off2);border-radius:3px;overflow:hidden">
                    <div style="height:100%;background:var(--green);border-radius:3px;transition:width .4s ease;width:0%"
                        id="assessProg"></div>
                </div>
                <span style="font-size:.75rem;font-weight:600;color:var(--muted);white-space:nowrap" id="assessLabel">0
                    / 5</span>
            </div>
        </div>
        <div id="assessQs">
            <div class="aq" data-qi="0"
                style="margin-bottom:1.8rem;padding-bottom:1.8rem;border-bottom:1px solid var(--border)">
                <div style="font-size:.93rem;font-weight:600;color:var(--ink);margin-bottom:.9rem;line-height:1.5">1.
                    How emotionally exhausted do you feel this fortnight?</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem">
                    <button class="topt" onclick="pickQ(this,0,0)">Rarely or never</button>
                    <button class="topt" onclick="pickQ(this,0,1)">Sometimes</button>
                    <button class="topt" onclick="pickQ(this,0,2)">Often</button>
                    <button class="topt" onclick="pickQ(this,0,3)">Almost always</button>
                </div>
            </div>
            <div class="aq" data-qi="1"
                style="margin-bottom:1.8rem;padding-bottom:1.8rem;border-bottom:1px solid var(--border)">
                <div style="font-size:.93rem;font-weight:600;color:var(--ink);margin-bottom:.9rem;line-height:1.5">2.
                    How would you rate your motivation at work?</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem">
                    <button class="topt" onclick="pickQ(this,1,0)">Very high</button>
                    <button class="topt" onclick="pickQ(this,1,1)">Moderate</button>
                    <button class="topt" onclick="pickQ(this,1,2)">Low</button>
                    <button class="topt" onclick="pickQ(this,1,3)">Very low</button>
                </div>
            </div>
            <div class="aq" data-qi="2"
                style="margin-bottom:1.8rem;padding-bottom:1.8rem;border-bottom:1px solid var(--border)">
                <div style="font-size:.93rem;font-weight:600;color:var(--ink);margin-bottom:.9rem;line-height:1.5">3.
                    How satisfied are you with your current workload?</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem">
                    <button class="topt" onclick="pickQ(this,2,0)">Very satisfied</button>
                    <button class="topt" onclick="pickQ(this,2,1)">Somewhat satisfied</button>
                    <button class="topt" onclick="pickQ(this,2,2)">Dissatisfied</button>
                    <button class="topt" onclick="pickQ(this,2,3)">Very dissatisfied</button>
                </div>
            </div>
            <div class="aq" data-qi="3"
                style="margin-bottom:1.8rem;padding-bottom:1.8rem;border-bottom:1px solid var(--border)">
                <div style="font-size:.93rem;font-weight:600;color:var(--ink);margin-bottom:.9rem;line-height:1.5">4.
                    How overwhelmed do you feel by your responsibilities?</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem">
                    <button class="topt" onclick="pickQ(this,3,0)">Not at all</button>
                    <button class="topt" onclick="pickQ(this,3,1)">Slightly</button>
                    <button class="topt" onclick="pickQ(this,3,2)">Considerably</button>
                    <button class="topt" onclick="pickQ(this,3,3)">Completely</button>
                </div>
            </div>
            <div class="aq" data-qi="4" style="margin-bottom:1.8rem;padding-bottom:0;border-bottom:none">
                <div style="font-size:.93rem;font-weight:600;color:var(--ink);margin-bottom:.9rem;line-height:1.5">5. Do
                    you feel supported by your team and manager?</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:.5rem">
                    <button class="topt" onclick="pickQ(this,4,0)">Strongly agree</button>
                    <button class="topt" onclick="pickQ(this,4,1)">Somewhat</button>
                    <button class="topt" onclick="pickQ(this,4,2)">Not really</button>
                    <button class="topt" onclick="pickQ(this,4,3)">Not at all</button>
                </div>
            </div>
        </div>
        <div id="assessResult" style="display:none"></div>
        <button class="btn" onclick="resetAssessment()"
            style="background:var(--muted);font-size:.8rem;padding:.55rem 1.3rem;margin-top:1rem">Reset
            Assessment</button>
    </div>
    <!-- HISTORY -->
    <div class="history-card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
            <div class="chart-label" style="margin-bottom:0">Previous Assessments</div>
        </div>
        <div id="historyList">
            <div class="history-item"><span class="history-date">14 Feb 2026</span><span><span
                        class="badge badge-green">Low Risk</span></span><span
                    style="font-weight:600;color:var(--green)">82%</span></div>
            <div class="history-item"><span class="history-date">31 Jan 2026</span><span><span
                        class="badge badge-amber">Moderate</span></span><span
                    style="font-weight:600;color:var(--amber)">58%</span></div>
            <div class="history-item"><span class="history-date">17 Jan 2026</span><span><span
                        class="badge badge-green">Low Risk</span></span><span
                    style="font-weight:600;color:var(--green)">76%</span></div>
            <div class="history-item"><span class="history-date">3 Jan 2026</span><span><span
                        class="badge badge-green">Low Risk</span></span><span
                    style="font-weight:600;color:var(--green)">88%</span></div>
        </div>
    </div>
</section>
<!-- CHECK-IN BOT -->
<section id="checkin" class="section">
    <div class="section-label">Simulation</div>
    <div class="section-title">Private Check-In Bot</div>
    <div class="section-sub">Experience what a confidential AI check-in feels like. This is a simulation.</div>
    <div class="chat-layout">
        <div class="chat-window">
            <div class="chat-head">
                <div class="chat-av">&#x1F33F;</div>
                <div>
                    <div class="chat-head-name">Wellbeing Assistant</div>
                    <div class="chat-head-status"><span class="online-dot"></span> Active &amp; private</div>
                </div>
            </div>
            <div class="chat-msgs" id="chatMsgs"></div>
            <div class="chat-foot" id="chatFoot">
                <div class="chat-foot-label">Choose a response</div>
                <div class="chat-opts" id="chatOpts"></div>
            </div>
        </div>
        <div class="chat-sidebar">
            <div class="side-card">
                <div class="side-label">Progress</div>
                <div class="prog-track">
                    <div class="prog-fill" id="chatProg"></div>
                </div>
                <div class="prog-text" id="chatProgText">Waiting to start...</div>
            </div>
            <div class="side-card">
                <div class="side-label">Wellbeing Score</div>
                <div class="score-badge" id="chatScore"></div>
                <div class="prog-text" id="chatScoreText" style="margin-top:.4rem">Complete the check-in to see your
                    score.</div>
            </div>
            <div class="side-card">
                <div class="side-label">Privacy Notice</div>
                <p class="privacy-note"><strong>This is a simulation.</strong> No data is stored, transmitted, or linked
                    to your identity. In a real system, all data would remain end-to-end encrypted and never shared with
                    HR or management.</p>
            </div>
        </div>
    </div>
    <button class="btn" onclick="startChat()" id="chatStartBtn">Start Check-In &#x2192;</button>
</section>
<!-- ETHICS -->
<section id="ethics" class="section">
    <div class="section-label">Principles</div>
    <div class="section-title">Ethical Design</div>
    <div class="section-sub">Every decision guided by one question: &#x201C;Does this protect the employee?&#x201D;
    </div>
    <div class="ethics-grid" id="ethicsGrid">
        <div class="ethics-card"><span class="ethics-icon">&#x1F91D;</span>
            <h4>Voluntary</h4>
            <p>No employee is required to use the system. Engagement is always opt-in.</p>
        </div>
        <div class="ethics-card"><span class="ethics-icon">&#x1F512;</span>
            <h4>Privacy-First</h4>
            <p>Data is not accessible to managers, HR, or performance teams. Structural confidentiality.</p>
        </div>
        <div class="ethics-card"><span class="ethics-icon">&#x1F6AB;</span>
            <h4>No Performance Link</h4>
            <p>Wellbeing data never used in appraisals, promotions, or disciplinary processes.</p>
        </div>
        <div class="ethics-card"><span class="ethics-icon">&#x1F9E0;</span>
            <h4>No AI Diagnosis</h4>
            <p>The system identifies signals, not conditions. It never labels employees.</p>
        </div>
        <div class="ethics-card"><span class="ethics-icon">&#x1F9D1;</span>
            <h4>AI Suggests, Humans Decide</h4>
            <p>All recommendations are suggestions. Employee retains full autonomy.</p>
        </div>
        <div class="ethics-card"><span class="ethics-icon">&#x1F4C8;</span>
            <h4>Trend-Based</h4>
            <p>Patterns over time trigger consideration &#x2014; never a single moment.</p>
        </div>
        <div class="ethics-card"><span class="ethics-icon">&#x1F464;</span>
            <h4>Anonymous Peer Input</h4>
            <p>Peer concerns are anonymous and weighted lightly. Never a sole trigger.</p>
        </div>
        <div class="ethics-card"><span class="ethics-icon">&#x1F331;</span>
            <h4>Support Continuity</h4>
            <p>Post-intervention monitoring ensures support does not end abruptly.</p>
        </div>
    </div>
</section>
<!-- OUTCOMES -->
<section id="outcomes" class="section">
    <div class="section-label">Results</div>
    <div class="section-title">Persistence Outcomes</div>
    <div class="section-sub">After combining all signals, the AI determines one of these outcomes.</div>
    <div style="overflow-x:auto">
        <table class="outcomes-table">
            <thead>
                <tr>
                    <th>Risk</th>
                    <th>AI Assessment</th>
                    <th>Response</th>
                    <th>Escalation</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="badge badge-green">Low</span></td>
                    <td>Temporary dip; no persistence</td>
                    <td>Self-help resources</td>
                    <td>&#x274C; None</td>
                </tr>
                <tr>
                    <td><span class="badge badge-amber">Moderate</span></td>
                    <td>Partial persistence; inconsistent</td>
                    <td>Monitor next cycle; peer support</td>
                    <td>&#x26A0;&#xFE0F; Watch</td>
                </tr>
                <tr>
                    <td><span class="badge badge-red">Persistent</span></td>
                    <td>Cross-test consistency confirmed</td>
                    <td>Private counsellor suggestion</td>
                    <td>&#x2705; Counsellor</td>
                </tr>
                <tr>
                    <td><span class="badge badge-purple">Crisis</span></td>
                    <td>Extreme distress pattern</td>
                    <td>Urgent private support</td>
                    <td>&#x1F198; Immediate</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="info-strip"><strong>Key principle:</strong> A single signal never triggers intervention. Only
        persistent, multi-source patterns cross the threshold.</div>
</section>
<!-- EMPLOYEE TEST -->
<section id="emptest" class="section">
    <div class="section-label">Self-Assessment</div>
    <div class="section-title">Employee Wellbeing Test</div>
    <div class="section-sub">Answer each scenario honestly. There are no right or wrong answers &#x2014; this helps you
        reflect on your own wellbeing.</div>
    <div style="height:5px;background:var(--off2);border-radius:3px;margin-bottom:2rem;overflow:hidden">
        <div id="testProg" style="height:100%;background:var(--green);width:0%;transition:width .5s;border-radius:3px">
        </div>
    </div>
    <div id="testBody">
        <div class="test-card" id="t1">
            <div class="test-q">1. You have been given extra responsibilities at short notice on top of your existing
                workload. How do you feel?</div>
            <div class="test-context">Think about how this would actually impact your day-to-day life.</div>
            <div class="test-opts">
                <button class="topt" onclick="tAnswer(this,'t1','a')">I can handle it &#x2014; I enjoy challenges and
                    will reprioritise.</button>
                <button class="topt" onclick="tAnswer(this,'t1','b')">I feel slightly anxious but I will manage with
                    some effort.</button>
                <button class="topt" onclick="tAnswer(this,'t1','c')">I feel overwhelmed &#x2014; I already have too
                    much on my plate.</button>
                <button class="topt" onclick="tAnswer(this,'t1','d')">I feel completely unable to cope and would need to
                    escalate.</button>
            </div>
            <div class="test-explain" id="exp-t1">Your response has been recorded privately. Remember: recognising your
                limits is a strength, not a weakness.</div>
        </div>
        <div class="test-card" id="t2">
            <div class="test-q">2. A colleague privately mentions they are struggling. What would you do?</div>
            <div class="test-context">Consider what you would genuinely do, not what you think you should do.</div>
            <div class="test-opts">
                <button class="topt" onclick="tAnswer(this,'t2','a')">Listen empathetically and ask how I can
                    help.</button>
                <button class="topt" onclick="tAnswer(this,'t2','b')">Suggest they use the wellbeing system or speak to
                    someone.</button>
                <button class="topt" onclick="tAnswer(this,'t2','c')">Want to help but feel unsure what to do or
                    say.</button>
                <button class="topt" onclick="tAnswer(this,'t2','d')">Feel uncomfortable &#x2014; I would try to avoid
                    the conversation.</button>
            </div>
            <div class="test-explain" id="exp-t2">All responses are valid. This system is designed to provide support
                options so no one has to figure it out alone.</div>
        </div>
        <div class="test-card" id="t3">
            <div class="test-q">3. On a typical workday, how do you feel when you wake up?</div>
            <div class="test-context">Be honest about your routine morning feelings, not your best days.</div>
            <div class="test-opts">
                <button class="topt" onclick="tAnswer(this,'t3','a')">Energised and looking forward to the day.</button>
                <button class="topt" onclick="tAnswer(this,'t3','b')">Neutral &#x2014; neither excited nor dreading
                    it.</button>
                <button class="topt" onclick="tAnswer(this,'t3','c')">Tired and reluctant to start work.</button>
                <button class="topt" onclick="tAnswer(this,'t3','d')">Anxious or deeply unmotivated most
                    mornings.</button>
            </div>
            <div class="test-explain" id="exp-t3">Morning feelings are a strong indicator of overall wellbeing.
                Persistent dread can be an early signal worth paying attention to.</div>
        </div>
        <div class="test-card" id="t4">
            <div class="test-q">4. Your manager gives you constructive feedback on a project. How do you react?</div>
            <div class="test-context">Think about your instinctive reaction, not the ideal one.</div>
            <div class="test-opts">
                <button class="topt" onclick="tAnswer(this,'t4','a')">I appreciate it and see it as a growth
                    opportunity.</button>
                <button class="topt" onclick="tAnswer(this,'t4','b')">I accept it but feel a bit disappointed.</button>
                <button class="topt" onclick="tAnswer(this,'t4','c')">I take it personally and it affects my
                    confidence.</button>
                <button class="topt" onclick="tAnswer(this,'t4','d')">I feel very upset and struggle to move past
                    it.</button>
            </div>
            <div class="test-explain" id="exp-t4">How you handle feedback reflects your emotional resilience. There is
                no wrong answer &#x2014; awareness is the first step.</div>
        </div>
        <div class="test-card" id="t5">
            <div class="test-q">5. Outside of work, how are you managing your personal wellbeing?</div>
            <div class="test-context">Consider sleep, exercise, social connections, and personal time.</div>
            <div class="test-opts">
                <button class="topt" onclick="tAnswer(this,'t5','a')">I have a good balance and make time for myself
                    regularly.</button>
                <button class="topt" onclick="tAnswer(this,'t5','b')">I try, but work sometimes gets in the
                    way.</button>
                <button class="topt" onclick="tAnswer(this,'t5','c')">I am struggling to find time for anything outside
                    work.</button>
                <button class="topt" onclick="tAnswer(this,'t5','d')">My personal life is significantly affected by work
                    stress.</button>
            </div>
            <div class="test-explain" id="exp-t5">Work-life balance is foundational to wellbeing. If work is
                consistently impacting your personal life, that is an important signal.</div>
        </div>
        <div class="test-card" id="t6">
            <div class="test-q">6. If this system flagged you for a voluntary counsellor session, how would you feel?
            </div>
            <div class="test-context">There is no judgement here &#x2014; just your honest reaction.</div>
            <div class="test-opts">
                <button class="topt" onclick="tAnswer(this,'t6','a')">I would welcome it &#x2014; professional support
                    is always helpful.</button>
                <button class="topt" onclick="tAnswer(this,'t6','b')">I would consider it, depending on how I felt at
                    the time.</button>
                <button class="topt" onclick="tAnswer(this,'t6','c')">I would be hesitant &#x2014; I prefer to handle
                    things myself.</button>
                <button class="topt" onclick="tAnswer(this,'t6','d')">I would feel stigmatised or worried about being
                    flagged.</button>
            </div>
            <div class="test-explain" id="exp-t6">Your comfort with professional support matters. This system is
                designed so that engaging is always your choice, and it is never visible to others.</div>
        </div>
        <button class="btn" onclick="showTestResult()">See My Reflection &#x2192;</button>
    </div>
    <div class="test-result" id="testResult">
        <h3 id="testResultTitle"></h3>
        <p id="testResultMsg"></p>
        <div id="testMeters" style="margin-top:2rem;text-align:left;max-width:560px;margin-left:auto;margin-right:auto">
        </div>
        <div id="testOverall" style="margin-top:2rem;text-align:center"></div>
        <div style="margin-top:1.5rem;text-align:center">
            <button class="btn" onclick="resetTest()" style="background:var(--muted)">Retake Test</button>
            <button class="btn btn-outline" onclick="openBookModal()" style="margin-left:.5rem">Book a Session</button>
        </div>
    </div>
</section>
<!-- TEAM VIEW (Manager / HR) -->
<section id="teamview" class="section">
    <div class="section-label">Administration</div>
    <div class="section-title" id="teamViewTitle">Team Insights</div>
    <div class="section-sub">Aggregate wellbeing analytics and anonymised employee signals.</div>

    <div class="dash-grid" style="margin-bottom: 2rem;">
        <div class="kpi blue" style="background: var(--blue-bg); border-color: var(--blue);">
            <div class="kpi-label">Team Avg Wellness</div>
            <div class="kpi-val" id="teamAvgWell">74%</div>
            <div class="kpi-sub">Stable across 42 employees</div>
        </div>
        <div class="kpi green" style="background: var(--green-bg); border-color: var(--green);">
            <div class="kpi-label">Participation Rate</div>
            <div class="kpi-val" id="teamPartRate">92%</div>
            <div class="kpi-sub">Check-ins completed this week</div>
        </div>
        <div class="kpi amber" style="background: var(--amber-bg); border-color: var(--amber);">
            <div class="kpi-label">High Risk Alerts</div>
            <div class="kpi-val" id="teamRiskCount">3</div>
            <div class="kpi-sub">Requires confidential outreach</div>
        </div>
    </div>

    <div class="history-card" style="margin-top: 0;">
        <div
            style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem">
            <div class="chart-label" style="margin-bottom:0">Employee Database</div>
            <div style="position:relative;flex:1;max-width:300px">
                <input type="text" id="dbSearch" placeholder="Search employees..." onkeyup="filterTeamDB()"
                    style="width:100%;padding:.5rem 1rem .5rem 2.2rem;border-radius:20px;border:1px solid var(--border);font-size:.82rem;background:var(--off)">
                <span
                    style="position:absolute;left:.8rem;top:50%;transform:translateY(-55%);font-size:.85rem;opacity:.5">&#x1F50D;</span>
            </div>
        </div>
        <div style="overflow-x:auto">
            <table class="outcomes-table" style="font-size: .82rem;">
                <thead>
                    <tr>
                        <th>Employee ID</th>
                        <th>Name</th>
                        <th>Role</th>
                        <th>Recent Signal</th>
                        <th>Calculated Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="teamDBBody">
                    <!-- Populated by JS -->
                </tbody>
            </table>
        </div>
    </div>
</section>
</div><!-- end mainApp -->
<canvas id="confetti-canvas" style="position:fixed;inset:0;z-index:999;pointer-events:none"></canvas>
<script>
    /* ============ LOGIN / AUTH ============ */
    const USERS = {
        'employee@demo.com': { pass: 'demo', role: 'employee', name: 'Alex Chen' },
        'manager@demo.com': { pass: 'demo', role: 'manager', name: 'Jordan Lee' },
        'hr@demo.com': { pass: 'demo', role: 'hr', name: 'Sam Parker' }
    };
    let curRole = 'employee', curUser = null;
    const ROLE_CFG = {
        employee: { emoji: '\u{1F44B}', title: 'Welcome back', msg: 'Your private wellbeing dashboard is ready.', feats: ['Check-In', 'Dashboard', 'Resources', 'Test'] },
        manager: { emoji: '\u{1F4CA}', title: 'Manager View', msg: 'Gain insights into team wellbeing trends \u2014 anonymised.', feats: ['Team View', 'Team Trends', 'Anonymous Signals', 'Support Tools'] },
        hr: { emoji: '\u{1F6E1}', title: 'HR Overview', msg: 'System-wide wellbeing analytics \u2014 fully privacy-compliant.', feats: ['Employee DB', 'Analytics', 'Policies', 'Ethics Review'] }
    };
    function pickRole(el, role) {
        curRole = role;
        document.querySelectorAll('#roleSelect .pill').forEach(p => { p.style.borderColor = 'var(--border2)'; p.style.background = 'var(--off)'; p.style.color = 'var(--muted)' });
        el.style.borderColor = 'var(--green)'; el.style.background = 'var(--green-bg)'; el.style.color = 'var(--green)';
    }
    function doLogin() {
        const email = document.getElementById('loginEmail').value.trim();
        const pass = document.getElementById('loginPass').value;
        const err = document.getElementById('loginError');
        if (!email || !pass) { err.textContent = 'Please enter email and password.'; err.style.display = 'block'; return }
        if (pass === 'demo') { curUser = { email, name: email.split('@')[0], role: curRole }; showWelcome(); return }
        const u = USERS[email.toLowerCase()];
        if (u && u.pass === pass) { curUser = { email, name: u.name, role: u.role }; curRole = u.role; showWelcome(); return }
        err.textContent = 'Invalid credentials. Use password "demo".'; err.style.display = 'block';
    }
    function showWelcome() {
        const cfg = ROLE_CFG[curRole];
        document.getElementById('welcomeEmoji').textContent = cfg.emoji;
        document.getElementById('welcomeRole').textContent = curRole.charAt(0).toUpperCase() + curRole.slice(1);
        document.getElementById('welcomeTitle').textContent = cfg.title;
        document.getElementById('welcomeMsg').textContent = cfg.msg;
        const fw = document.getElementById('welcomeFeats'); fw.innerHTML = '';
        cfg.feats.forEach(f => { const s = document.createElement('span'); s.className = 'pill'; s.textContent = f; fw.appendChild(s) });
        document.getElementById('loginPage').style.display = 'none';
        document.getElementById('welcomeScreen').style.display = 'flex';
    }
    function enterApp() {
        document.getElementById('welcomeScreen').style.display = 'none';
        document.getElementById('mainApp').style.display = 'block';
        document.getElementById('toolbar').classList.add('show');
        const name = curUser ? curUser.name : 'Demo User';
        document.getElementById('tbName').textContent = name;
        document.getElementById('dashName').textContent = name;
        document.getElementById('dashRole').textContent = curRole;
        document.getElementById('dashAvatar').textContent = curRole === 'employee' ? '\u{1F464}' : curRole === 'manager' ? '\u{1F4CA}' : '\u{1F6E1}';

        const teamTab = document.getElementById('teamTab');
        if (curRole === 'manager' || curRole === 'hr') {
            teamTab.style.display = 'block';
            teamTab.textContent = curRole === 'manager' ? 'Team View' : 'Employee DB';
            renderTeamView();
        } else {
            teamTab.style.display = 'none';
        }

        renderNotifs(); initCharts(); animateSteps(); updateWellnessRing(null);
    }
    function goToLogin() {
        document.getElementById('mainApp').style.display = 'none';
        document.getElementById('toolbar').classList.remove('show');
        document.getElementById('loginPage').style.display = 'flex';
        document.getElementById('loginError').style.display = 'none';
        document.getElementById('loginPass').value = '';
        curUser = null;
    }

    /* ============ DARK MODE ============ */
    function toggleDark() {
        document.body.classList.toggle('dark');
        const isDark = document.body.classList.contains('dark');
        document.getElementById('darkBtn').textContent = isDark ? '\u2600\uFE0F' : '\u{1F319}';
        localStorage.setItem('wb-theme', isDark ? 'dark' : 'light');
    }
    (function () { if (localStorage.getItem('wb-theme') === 'dark') { document.body.classList.add('dark'); const b = document.getElementById('darkBtn'); if (b) b.textContent = '\u2600\uFE0F' } })();

    /* ============ NOTIFICATIONS ============ */
    let notifs = [
        { id: 1, icon: '\u{1F514}', title: 'Welcome', msg: 'Your wellbeing dashboard is ready.', time: 'Just now', read: false },
        { id: 2, icon: '\u{1F4CB}', title: 'Check-In Due', msg: 'Your fortnightly check-in is available.', time: '2h ago', read: false },
        { id: 3, icon: '\u{1F33F}', title: 'New Resources', msg: 'Mindfulness exercises have been added.', time: '1d ago', read: false }
    ];
    function renderNotifs() {
        const list = document.getElementById('notifList');
        const badge = document.getElementById('notifBadge');
        const count = document.getElementById('notifCount');
        const unread = notifs.filter(n => !n.read).length;
        badge.textContent = unread; badge.style.display = unread ? 'flex' : 'none';
        count.textContent = notifs.length + ' notification' + (notifs.length !== 1 ? 's' : '');
        if (!notifs.length) { list.innerHTML = '<div style="padding:2rem;text-align:center;color:var(--muted2);font-size:.86rem">You are all caught up!</div>'; return }
        list.innerHTML = notifs.map(n => `<div class="notif-item ${n.read ? '' : 'unread'}" onclick="markRead(${n.id})"><span class="notif-icon">${n.icon}</span><div class="notif-body"><div class="n-title">${n.title}</div><div class="n-msg">${n.msg}</div><div class="n-time">${n.time}</div></div></div>`).join('');
    }
    function toggleNotif() { document.getElementById('notifPanel').classList.toggle('show') }
    function markRead(id) { const n = notifs.find(x => x.id === id); if (n) n.read = true; renderNotifs() }
    function clearAll() { notifs = []; renderNotifs() }

    /* ============ TAB SWITCHING ============ */
    document.getElementById('navTabs').addEventListener('click', function (e) {
        const btn = e.target.closest('.tab-btn'); if (!btn) return;
        const id = btn.dataset.tab;
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active'); btn.classList.add('active');
        if (id === 'workflow') animateSteps();
        if (id === 'ethics') animateCards();
    });

    /* ============ ANIMATIONS ============ */
    function animateSteps() { document.querySelectorAll('.step').forEach((s, i) => { s.classList.remove('visible'); setTimeout(() => s.classList.add('visible'), i * 120) }) }
    function animateCards() { document.querySelectorAll('.ethics-card').forEach((c, i) => { c.classList.remove('visible'); setTimeout(() => c.classList.add('visible'), i * 80) }) }

    /* ============ WELLNESS RING ============ */
    function updateWellnessRing(val) {
        const ring = document.getElementById('wellRing');
        const label = document.getElementById('wellVal');
        const circ = 2 * Math.PI * 52; // ~326.7
        if (val === null || val === undefined) {
            ring.style.strokeDashoffset = circ; label.textContent = '\u2014'; ring.style.stroke = 'var(--muted2)'; return;
        }
        const offset = circ - (val / 100) * circ;
        ring.style.strokeDashoffset = offset;
        label.textContent = val + '%';
        if (val >= 70) { ring.style.stroke = 'var(--green)'; label.style.color = 'var(--green)' }
        else if (val >= 40) { ring.style.stroke = 'var(--amber)'; label.style.color = 'var(--amber)' }
        else { ring.style.stroke = 'var(--red)'; label.style.color = 'var(--red)' }
    }

    /* ============ DASHBOARD ============ */
    let assessAns = [null, null, null, null, null], radarChart, donutChart, assessCount = 4;
    function pickQ(el, qi, val) {
        if (assessAns[qi] !== null) return;
        assessAns[qi] = val;
        const aq = el.closest('.aq');
        aq.querySelectorAll('.topt').forEach(o => o.classList.add('locked'));
        el.classList.add('picked');
        updateAssessProgress(); dashUpdate();
    }
    function updateAssessProgress() {
        const done = assessAns.filter(a => a !== null).length;
        document.getElementById('assessProg').style.width = (done / 5 * 100) + '%';
        document.getElementById('assessLabel').textContent = done + ' / 5';
    }
    function dashUpdate() {
        const vals = assessAns.filter(v => v !== null); if (!vals.length) return;
        const avg = vals.reduce((a, b) => a + b, 0) / vals.length;
        const risk = Math.round(avg / 3 * 100);
        const well = 100 - risk;
        document.getElementById('kRisk').textContent = risk + '%';
        document.getElementById('kClass').textContent = risk < 35 ? 'Low' : risk < 65 ? 'Medium' : 'High';
        document.getElementById('kStress').textContent = risk + '%';
        updateWellnessRing(well);
        if (radarChart) {
            const dims = [assessAns[0] ?? 0, assessAns[1] ?? 0, assessAns[2] ?? 0, assessAns[3] ?? 0, assessAns[4] ?? 0].map(v => v / 3 * 100);
            radarChart.data.datasets[0].data = dims; radarChart.update();
        }
        if (donutChart) {
            const c = assessAns.filter(v => v !== null);
            const lo = c.filter(v => v <= 1).length, hi = c.filter(v => v >= 2).length;
            donutChart.data.datasets[0].data = [lo, hi]; donutChart.update();
        }
        // Show result when all answered
        if (vals.length === 5) {
            assessCount++;
            document.getElementById('totalAssess').textContent = assessCount;
            document.getElementById('lastCheckin').textContent = new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' });
            const res = document.getElementById('assessResult');
            let cls = risk < 35 ? 'low' : risk < 65 ? 'med' : 'high';
            let title = risk < 35 ? 'Low Risk \u2014 You are doing well!' : risk < 65 ? 'Moderate Signal \u2014 Worth monitoring' : '\u26A0\uFE0F High Signal \u2014 Support is available';
            let msg = risk < 35 ? 'Your responses suggest a healthy state. Keep it up! Self-help resources are available anytime.' : risk < 65 ? 'Some areas show signs of stress. Consider exploring mindfulness resources or talking to someone.' : 'Your responses indicate significant stress. Remember, speaking with a counsellor is private, voluntary, and support-focused.';
            res.innerHTML = `<div style="border-radius:var(--radius);border:1px solid;padding:1.2rem 1.5rem;animation:fadeUp .3s ease;background:var(--${cls === 'low' ? 'green' : cls === 'med' ? 'amber' : 'red'}-bg);border-color:rgba(${cls === 'low' ? '26,122,74' : cls === 'med' ? '184,92,0' : '192,48,42'},.25)"><div style="font-weight:700;font-size:.95rem;margin-bottom:.4rem;color:var(--${cls === 'low' ? 'green' : cls === 'med' ? 'amber' : 'red'})">${title}</div><div style="font-size:.84rem;color:var(--muted);line-height:1.65;font-weight:300">${msg}</div>${risk >= 50 ? '<button class="btn" onclick="openBookModal()" style="margin-top:1rem;padding:.55rem 1.3rem;font-size:.82rem">Book a Counsellor Session \u2192</button>' : ''}</div>`;
            res.style.display = 'block';
        }
    }
    function resetAssessment() {
        assessAns = [null, null, null, null, null];
        document.querySelectorAll('#assessQs .topt').forEach(o => { o.classList.remove('picked', 'locked') });
        updateAssessProgress();
        ['kRisk', 'kClass', 'kStress'].forEach(id => { document.getElementById(id).textContent = '\u2014' });
        updateWellnessRing(null);
        if (radarChart) { radarChart.data.datasets[0].data = [0, 0, 0, 0, 0]; radarChart.update() }
        if (donutChart) { donutChart.data.datasets[0].data = [0, 0]; donutChart.update() }
        document.getElementById('assessResult').style.display = 'none';
    }
    function initCharts() {
        const rCtx = document.getElementById('radarChart');
        const dCtx = document.getElementById('donutChart');
        if (!rCtx || !dCtx) return;
        radarChart = new Chart(rCtx, { type: 'radar', data: { labels: ['Exhaustion', 'Motivation', 'Satisfaction', 'Overwhelm', 'Support'], datasets: [{ data: [0, 0, 0, 0, 0], backgroundColor: 'rgba(26,122,74,.15)', borderColor: '#1a7a4a', pointBackgroundColor: '#1a7a4a', pointRadius: 3 }] }, options: { responsive: true, maintainAspectRatio: false, scales: { r: { beginAtZero: true, max: 100, ticks: { display: false }, grid: { color: 'rgba(0,0,0,.06)' }, pointLabels: { font: { family: 'Outfit', size: 10 } } } }, plugins: { legend: { display: false } } } });
        donutChart = new Chart(dCtx, { type: 'doughnut', data: { labels: ['Healthy', 'Flagged'], datasets: [{ data: [0, 0], backgroundColor: ['#1a7a4a', '#c0302a'], borderWidth: 0 }] }, options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { position: 'bottom', labels: { font: { family: 'Outfit', size: 11 }, padding: 15 } } } } });
    }

    /* ============ COUNSELLOR BOOKING ============ */
    function openBookModal() {
        document.getElementById('bookForm').style.display = 'block';
        document.getElementById('bookSuccess').style.display = 'none';
        // Set default date to tomorrow
        const tmr = new Date(); tmr.setDate(tmr.getDate() + 1);
        document.getElementById('bookDate').value = tmr.toISOString().split('T')[0];
        document.getElementById('bookModal').classList.add('show');
    }
    function closeBookModal() { document.getElementById('bookModal').classList.remove('show') }
    function confirmBooking() {
        document.getElementById('bookForm').style.display = 'none';
        document.getElementById('bookSuccess').style.display = 'block';
        // Add notification
        notifs.unshift({ id: Date.now(), icon: '\u{1F4C5}', title: 'Session Booked', msg: 'Your counsellor session has been confirmed.', time: 'Just now', read: false });
        renderNotifs();
    }
    // Close modal on overlay click
    document.getElementById('bookModal').addEventListener('click', function (e) { if (e.target === this) closeBookModal() });

    /* ============ CHATBOT ============ */
    const chatScript = [
        { bot: "Hi! I'm your wellbeing assistant. This is a private, anonymous check-in. Ready to begin?", opts: [{ text: "Yes, let's start", score: 0 }, { text: "I'm not sure", score: 1 }] },
        { bot: "How would you describe your energy levels this fortnight?", opts: [{ text: "Good \u2014 feeling energised", score: 0 }, { text: "Okay, but tired sometimes", score: 1 }, { text: "Very low and drained", score: 2 }] },
        { bot: "Have you felt overwhelmed by your workload recently?", opts: [{ text: "Not really", score: 0 }, { text: "Somewhat \u2014 it's been busy", score: 1 }, { text: "Yes, significantly", score: 2 }] },
        { bot: "Do you feel supported by your team and manager?", opts: [{ text: "Absolutely", score: 0 }, { text: "To some extent", score: 1 }, { text: "Not at all", score: 2 }] },
        { bot: "How would you rate your overall motivation at work?", opts: [{ text: "High \u2014 I'm engaged", score: 0 }, { text: "Mixed \u2014 it varies", score: 1 }, { text: "Low \u2014 struggling", score: 2 }] }
    ];
    let chatStep = -1, chatTotal = 0;
    function startChat() {
        chatStep = -1; chatTotal = 0;
        document.getElementById('chatMsgs').innerHTML = '';
        document.getElementById('chatOpts').innerHTML = '';
        document.getElementById('chatProg').style.width = '0%';
        document.getElementById('chatProgText').textContent = 'Starting...';
        const sb = document.getElementById('chatScore'); sb.className = 'score-badge'; sb.style.display = 'none';
        document.getElementById('chatScoreText').textContent = 'Complete the check-in to see your score.';
        document.getElementById('chatStartBtn').style.display = 'none';
        nextChatStep();
    }
    function nextChatStep() {
        chatStep++;
        if (chatStep >= chatScript.length) { finishChat(); return }
        const s = chatScript[chatStep];
        showTyping(() => {
            botMsg(s.bot);
            const opts = document.getElementById('chatOpts'); opts.innerHTML = '';
            s.opts.forEach(o => {
                const b = document.createElement('button'); b.className = 'copt'; b.textContent = o.text;
                b.onclick = function () { pick(o.text, o.score, b) }; opts.appendChild(b)
            });
            progUpdate();
        });
    }
    function showTyping(cb) {
        const msgs = document.getElementById('chatMsgs');
        const tDiv = document.createElement('div'); tDiv.className = 'msg bot';
        tDiv.innerHTML = '<div class="msg-av">\u{1F33F}</div><div class="msg-bub typing-bub"><span></span><span></span><span></span></div>';
        msgs.appendChild(tDiv); msgs.scrollTop = msgs.scrollHeight;
        setTimeout(() => { tDiv.remove(); cb() }, 900);
    }
    function botMsg(text) {
        const msgs = document.getElementById('chatMsgs');
        const d = document.createElement('div'); d.className = 'msg bot';
        d.innerHTML = `<div class="msg-av">\u{1F33F}</div><div class="msg-bub">${text}</div>`;
        msgs.appendChild(d); msgs.scrollTop = msgs.scrollHeight;
    }
    function userMsg(text) {
        const msgs = document.getElementById('chatMsgs');
        const d = document.createElement('div'); d.className = 'msg user';
        d.innerHTML = `<div class="msg-av">\u{1F464}</div><div class="msg-bub">${text}</div>`;
        msgs.appendChild(d); msgs.scrollTop = msgs.scrollHeight;
    }
    function pick(text, score, btn) {
        document.querySelectorAll('#chatOpts .copt').forEach(c => c.classList.add('used'));
        userMsg(text); chatTotal += score;
        setTimeout(nextChatStep, 500);
    }
    function progUpdate() {
        const pct = Math.round((chatStep + 1) / chatScript.length * 100);
        document.getElementById('chatProg').style.width = pct + '%';
        document.getElementById('chatProgText').textContent = `Step ${chatStep + 1} of ${chatScript.length}`;
    }
    function finishChat() {
        const maxScore = chatScript.reduce((a, s) => a + Math.max(...s.opts.map(o => o.score)), 0);
        const pct = Math.round(chatTotal / maxScore * 100);
        document.getElementById('chatProg').style.width = '100%';
        document.getElementById('chatProgText').textContent = 'Complete!';
        let level, cls;
        if (pct < 35) { level = 'Low Risk \u2014 Doing well!'; cls = 'low' }
        else if (pct < 65) { level = 'Medium Signal \u2014 Monitor'; cls = 'med' }
        else { level = 'High Signal \u2014 Support available'; cls = 'high' }
        showTyping(() => {
            botMsg(`Thanks for completing this check-in. Based on your responses, your wellbeing signal is: <strong>${level}</strong>. Remember \u2014 this is supportive, never evaluative.`);
            const sb = document.getElementById('chatScore');
            sb.className = 'score-badge show';
            sb.style.background = cls === 'low' ? 'var(--green-bg)' : cls === 'med' ? 'var(--amber-bg)' : 'var(--red-bg)';
            sb.style.color = cls === 'low' ? 'var(--green)' : cls === 'med' ? 'var(--amber)' : 'var(--red)';
            sb.style.borderColor = cls === 'low' ? 'rgba(26,122,74,.3)' : cls === 'med' ? 'rgba(184,92,0,.3)' : 'rgba(192,48,42,.3)';
            sb.textContent = level;
            document.getElementById('chatScoreText').textContent = 'Based on your simulated responses.';
            document.getElementById('chatOpts').innerHTML = '<span style="font-size:.82rem;color:var(--muted)">Check-in complete</span>';
        });
    }

    /* ============ EMPLOYEE TEST ============ */
    let tAnswers = {}, totalTs = 6;
    function tAnswer(el, tId, choice) {
        const card = document.getElementById(tId); if (card.dataset.answered) return;
        card.dataset.answered = 'true'; tAnswers[tId] = choice;
        card.querySelectorAll('.topt').forEach(o => { o.classList.add('locked') });
        el.classList.add('picked');
        document.getElementById('exp-' + tId).classList.add('show');
        const done = Object.keys(tAnswers).length;
        document.getElementById('testProg').style.width = (done / totalTs * 100) + '%';
        // Smooth scroll to next card
        const next = card.nextElementSibling;
        if (next && next.classList.contains('test-card')) {
            setTimeout(() => next.scrollIntoView({ behavior: 'smooth', block: 'center' }), 400);
        }
    }
    const TEST_DIMS = [
        { id: 't1', label: 'Workload Resilience', icon: '\u{1F4BC}' },
        { id: 't2', label: 'Empathy & Awareness', icon: '\u{1F91D}' },
        { id: 't3', label: 'Morning Energy', icon: '\u2600\uFE0F' },
        { id: 't4', label: 'Emotional Resilience', icon: '\u{1F9E0}' },
        { id: 't5', label: 'Work-Life Balance', icon: '\u2696\uFE0F' },
        { id: 't6', label: 'Openness to Support', icon: '\u{1F49A}' }
    ];
    function meterColor(pct) {
        if (pct <= 25) return 'var(--green)';
        if (pct <= 50) return 'var(--blue)';
        if (pct <= 75) return 'var(--amber)';
        return 'var(--red)';
    }
    function meterLabel(pct) {
        if (pct <= 25) return 'Thriving';
        if (pct <= 50) return 'Stable';
        if (pct <= 75) return 'Elevated';
        return 'High';
    }
    function showTestResult() {
        const done = Object.keys(tAnswers).length;
        if (done < totalTs) { alert('Please answer all ' + totalTs + ' questions first.'); return }
        const levels = { a: 0, b: 1, c: 2, d: 3 };
        const total = Object.values(tAnswers).reduce((s, v) => s + levels[v], 0);
        const maxVal = totalTs * 3;
        const pct = Math.round(total / maxVal * 100);
        document.getElementById('testBody').style.display = 'none';
        const res = document.getElementById('testResult'); res.style.display = 'block';
        let title, msg;
        if (pct <= 25) {
            title = '\u{1F33F} You are thriving!';
            msg = 'Your responses indicate strong resilience and healthy coping. Keep nurturing these habits!';
        } else if (pct <= 50) {
            title = '\u{1F331} Mostly well, with some areas to watch';
            msg = 'You are generally doing well, but some responses suggest mild stress. Consider exploring self-help resources.';
        } else if (pct <= 75) {
            title = '\u26A0\uFE0F Some stress signals detected';
            msg = 'Your responses suggest notable stress. Consider speaking with someone \u2014 the system can connect you privately.';
        } else {
            title = '\u{1F9E1} Significant stress \u2014 support is here';
            msg = 'High stress across multiple areas. You do not have to handle this alone. Everything remains private and voluntary.';
        }
        document.getElementById('testResultTitle').textContent = title;
        document.getElementById('testResultMsg').textContent = msg;
        // Build per-dimension meters
        let metersHTML = '<div style="font-weight:700;font-size:.95rem;color:var(--ink);margin-bottom:1.2rem;text-align:center">Stress Breakdown by Dimension</div>';
        TEST_DIMS.forEach((dim, i) => {
            const val = levels[tAnswers[dim.id]] || 0;
            const dimPct = Math.round(val / 3 * 100);
            const color = meterColor(dimPct);
            const label = meterLabel(dimPct);
            metersHTML += `<div class="stress-meter" style="animation-delay:${i * 0.1}s">
                <div class="sm-head">
                    <span class="sm-icon">${dim.icon}</span>
                    <span class="sm-label">${dim.label}</span>
                    <span class="sm-pct" style="color:${color}">${dimPct}%</span>
                    <span class="sm-tag" style="background:${color}15;color:${color};border:1px solid ${color}30">${label}</span>
                </div>
                <div class="sm-track">
                    <div class="sm-fill" style="background:${color};width:0%" data-target="${dimPct}"></div>
                </div>
            </div>`;
        });
        document.getElementById('testMeters').innerHTML = metersHTML;
        // Build overall gauge
        const oColor = meterColor(pct);
        const oLabel = meterLabel(pct);
        const circ = 2 * Math.PI * 58;
        const oOffset = circ - (pct / 100) * circ;
        document.getElementById('testOverall').innerHTML = `
            <div style="font-weight:700;font-size:.95rem;color:var(--ink);margin-bottom:1rem">Overall Stress Level</div>
            <div style="position:relative;display:inline-block;width:150px;height:150px">
                <svg viewBox="0 0 140 140" style="width:150px;height:150px;transform:rotate(-90deg)">
                    <circle cx="70" cy="70" r="58" fill="none" stroke="var(--off2)" stroke-width="10"/>
                    <circle cx="70" cy="70" r="58" fill="none" stroke="${oColor}" stroke-width="10"
                        stroke-dasharray="${circ}" stroke-dashoffset="${circ}" stroke-linecap="round"
                        id="testOverallRing" style="transition:stroke-dashoffset 1.2s cubic-bezier(.4,0,.2,1)"/>
                </svg>
                <div style="position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center">
                    <span style="font-family:'Playfair Display',serif;font-size:2rem;font-weight:900;color:${oColor}" id="testOverallVal">0%</span>
                    <span style="font-size:.72rem;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:.08em">${oLabel}</span>
                </div>
            </div>`;
        // Animate meters after paint
        requestAnimationFrame(() => {
            setTimeout(() => {
                document.querySelectorAll('.sm-fill').forEach(bar => {
                    bar.style.width = bar.dataset.target + '%';
                });
                const ring = document.getElementById('testOverallRing');
                if (ring) ring.style.strokeDashoffset = oOffset;
                // Animate counter
                let cur = 0;
                const valEl = document.getElementById('testOverallVal');
                const step = () => {
                    cur += Math.ceil(pct / 30);
                    if (cur >= pct) { cur = pct; valEl.textContent = cur + '%'; return; }
                    valEl.textContent = cur + '%';
                    requestAnimationFrame(step);
                };
                step();
            }, 80);
        });
        // Scroll to results
        res.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
    function resetTest() {
        tAnswers = {};
        document.querySelectorAll('.test-card').forEach(c => {
            delete c.dataset.answered;
            c.querySelectorAll('.topt').forEach(o => { o.classList.remove('picked', 'locked') });
            c.querySelectorAll('.test-explain').forEach(f => f.classList.remove('show'));
        });
        document.getElementById('testBody').style.display = 'block';
        document.getElementById('testResult').style.display = 'none';
        document.getElementById('testProg').style.width = '0%';
    }

    /* ============ TEAM VIEW (MANAGER / HR) ============ */
    const TEAM_DATA = [
        { id: 'E-4812', name: 'Alex Johnson', role: 'Software Engineer', part: '100%', signal: 'Stable', status: 'Healthy', well: 88, scores: [12, 15, 8, 10, 20, 5] },
        { id: 'E-5291', name: 'Sam Miller', role: 'Product Manager', part: '100%', signal: 'Trend-High', status: 'Action Required', well: 32, scores: [85, 42, 90, 78, 95, 20] },
        { id: 'E-1022', name: 'Jordan Lee', role: 'UX Designer', part: '80%', signal: 'Stable', status: 'Healthy', well: 76, scores: [25, 30, 15, 22, 40, 10] },
        { id: 'E-3341', name: 'Taylor Swift', role: 'Data Analyst', part: '100%', signal: 'Trend-Med', status: 'Monitoring', well: 54, scores: [55, 40, 62, 58, 65, 30] },
        { id: 'E-9902', name: 'Casey Jones', role: 'Software Engineer', part: '100%', signal: 'Stable', status: 'Healthy', well: 82, scores: [18, 22, 12, 15, 25, 5] },
        { id: 'E-1244', name: 'Morgan Fre', role: 'HR Specialist', part: '100%', signal: 'Stable', status: 'Healthy', well: 79, scores: [20, 25, 18, 20, 30, 8] },
        { id: 'E-8812', name: 'Riley Reid', role: 'Sales Lead', part: '60%', signal: 'Trend-Med', status: 'Monitoring', well: 48, scores: [65, 45, 58, 70, 75, 40] },
        { id: 'E-4011', name: 'Jamie Fox', role: 'Marketing Coord', part: '100%', signal: 'Stable', status: 'Healthy', well: 91, scores: [10, 12, 5, 8, 15, 5] },
        { id: 'E-2290', name: 'Chris Pratt', role: 'Software Engineer', part: '100%', signal: 'Trend-High', status: 'Action Required', well: 28, scores: [92, 48, 85, 82, 98, 15] }
    ];

    function renderTeamView() {
        const body = document.getElementById('teamDBBody');
        if (!body) return;

        body.innerHTML = TEAM_DATA.map(emp => {
            const statusCls = emp.status === 'Healthy' ? 'badge-green' : emp.status === 'Monitoring' ? 'badge-amber' : 'badge-red';
            const signalCls = emp.signal === 'Stable' ? 'var(--green)' : emp.signal.includes('Med') ? 'var(--amber)' : 'var(--red)';

            return `<tr>
                <td style="font-weight:700;color:var(--ink)">${emp.id}</td>
                <td style="font-weight:500">${emp.name}</td>
                <td>${emp.role}</td>
                <td style="color:${signalCls};font-weight:600">${emp.signal}</td>
                <td><span class="badge ${statusCls}">${emp.status}</span></td>
                <td><button class="btn-outline" style="font-size:.7rem;padding:.3rem .7rem" onclick="openDetailsModal('${emp.id}')">View Scores</button></td>
            </tr>`;
        }).join('');

        // Update stats
        const avgWell = Math.round(TEAM_DATA.reduce((s, e) => s + e.well, 0) / TEAM_DATA.length);
        const highRisk = TEAM_DATA.filter(e => e.status === 'Action Required').length;
        const partRate = Math.round(TEAM_DATA.reduce((s, e) => s + parseInt(e.part), 0) / TEAM_DATA.length);

        document.getElementById('teamAvgWell').textContent = avgWell + '%';
        document.getElementById('teamRiskCount').textContent = highRisk;
        document.getElementById('teamPartRate').textContent = partRate + '%';

        const title = document.getElementById('teamViewTitle');
        if (title) title.textContent = curRole === 'manager' ? 'Team Insights' : 'Organization Database';
    }

    function filterTeamDB() {
        const query = document.getElementById('dbSearch').value.toLowerCase();
        const rows = document.querySelectorAll('#teamDBBody tr');
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(query) ? '' : 'none';
        });
    }

    function openDetailsModal(id) {
        const emp = TEAM_DATA.find(e => e.id === id);
        if (!emp) return;

        document.getElementById('detName').textContent = emp.name + ' (' + emp.id + ')';
        document.getElementById('detRole').textContent = 'Role: ' + emp.role;
        document.getElementById('detAvatar').textContent = '\u{1F464}';

        const meters = document.getElementById('detMeters');
        meters.innerHTML = TEST_DIMS.map((dim, i) => {
            const pct = emp.scores[i];
            const color = meterColor(pct);
            const label = meterLabel(pct);
            return `<div class="stress-meter">
                <div class="sm-head">
                    <span class="sm-icon">${dim.icon}</span>
                    <span class="sm-label">${dim.label}</span>
                    <span class="sm-tag" style="background:${color}20; color:${color}">${label}</span>
                    <span class="sm-pct">${pct}%</span>
                </div>
                <div class="sm-track"><div class="sm-fill" style="width:${pct}%; background:${color}"></div></div>
            </div>`;
        }).join('');

        let summary = 'This employee shows <strong>' + emp.status + '</strong> signs. ';
        if (emp.status === 'Healthy') summary += 'Wellbeing signals are stable and positive.';
        else if (emp.status === 'Monitoring') summary += 'Minor fluctuations detected in ' + TEST_DIMS[4].label + '. Recommended low-touch support.';
        else summary += 'Persistent high-stress indicators in ' + TEST_DIMS[0].label + ' and ' + TEST_DIMS[2].label + '. Direct confidential outreach recommended.';

        document.getElementById('detSummary').innerHTML = summary;
        document.getElementById('detailsModal').classList.add('show');
    }

    function closeDetailsModal() {
        document.getElementById('detailsModal').classList.remove('show');
    }

    /* ============ CONFETTI ============ */
    function launchConfetti() {
        const c = document.getElementById('confetti-canvas'), ctx = c.getContext('2d');
        c.width = window.innerWidth; c.height = window.innerHeight;
        const pieces = [], colors = ['#1a7a4a', '#2da863', '#b85c00', '#1d5fa8', '#c0302a', '#6b3fa0'];
        for (let i = 0; i < 120; i++)pieces.push({ x: c.width / 2, y: c.height / 2, vx: (Math.random() - .5) * 16, vy: Math.random() * -14 - 4, r: Math.random() * 6 + 3, c: colors[Math.floor(Math.random() * colors.length)], a: 1, g: .25 });
        let frame = 0;
        function draw() {
            ctx.clearRect(0, 0, c.width, c.height); let alive = false;
            pieces.forEach(p => {
                if (p.a <= 0) return; alive = true; p.x += p.vx; p.vy += p.g; p.y += p.vy; p.a -= .008;
                ctx.globalAlpha = Math.max(0, p.a); ctx.fillStyle = p.c; ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2); ctx.fill()
            });
            ctx.globalAlpha = 1; frame++; if (alive && frame < 180) requestAnimationFrame(draw); else ctx.clearRect(0, 0, c.width, c.height)
        }
        draw();
    }
</script>
</body>

</html>
